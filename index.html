<!doctype html>
<html lang="it">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover, user-scalable=no">
<title>Lane Battle PWA</title>
<link rel="manifest" href="manifest.webmanifest">
<meta name="theme-color" content="#0b1220">
<link rel="apple-touch-icon" href="assets/sprites/tank.png">
<style>
  :root {
    --bg:#0b1220;
    --panel:#121a2e;
    --accent:#3ea6ff;
    --accent2:#7ee787;
    --danger:#ff6b6b;
    --text:#e6edf3;
  }
  * { box-sizing: border-box; }
  html, body { height: 100%; margin: 0; background: var(--bg); color: var(--text); font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; }
  .wrap { display:flex; flex-direction:column; height:100vh; max-width:480px; margin:0 auto; }
  header { padding:10px 12px; background:var(--panel); display:flex; align-items:center; justify-content:space-between; gap:8px; position:sticky; top:0; z-index:5; }
  header .title { font-weight:700; letter-spacing:.3px; }
  #status { font-size:12px; opacity:.85; }
  #gameArea { flex:1 1 auto; display:flex; align-items:center; justify-content:center; background:linear-gradient(#6aa06a,#93be93); position:relative; }
  canvas { width:100%; height:100%; max-height: calc(100vh - 200px); border-top:2px solid rgba(255,255,255,.08); border-bottom:2px solid rgba(0,0,0,.2); }
  .hud { background:var(--panel); padding:10px; }
  .mana { height:10px; background:#20304d; border-radius:6px; overflow:hidden; margin-bottom:10px; }
  .mana > div { height:100%; background:var(--accent); width:0%; transition:width .2s ease; }
  .cards { display:grid; grid-template-columns: repeat(5, 1fr); gap:8px; }
  .card { background:#0e1527; border:1px solid rgba(255,255,255,.08); border-radius:12px; padding:8px; display:flex; flex-direction:column; align-items:center; justify-content:center; gap:6px; min-height:72px; user-select:none; }
  .card img { width:28px; height:28px; image-rendering:crisp-edges; image-rendering: pixelated; }
  .card .name { font-size:12px; opacity:.95; }
  .card .cost { font-size:11px; opacity:.8; }
  .card.disabled { opacity:.4; }
  .laneHint { position:absolute; top:8px; left:0; right:0; text-align:center; font-size:12px; background:rgba(0,0,0,.28); padding:4px 8px; border-radius:8px; margin:0 auto; max-width: 95%; }
  @media (orientation: landscape) {
    /* hint to rotate */
    .rotate-hint { position:fixed; inset:0; background:#0b1220; display:flex; align-items:center; justify-content:center; color:#fff; z-index:9999; }
  }
</style>
</head>
<body>
<div class="wrap">
  <header>
    <div class="title">⚔️ Lane Battle</div>
    <div id="status">Tocca una corsia, poi una carta</div>
  </header>
  <div id="gameArea">
    <canvas id="game" width="360" height="520"></canvas>
    <div class="laneHint">Centro: +10% velocità, +15% danni subiti</div>
  </div>
  <div class="hud">
    <div class="mana"><div id="manaBar"></div></div>
    <div class="cards">
      <div class="card" data-unit="scout"><img src="assets/sprites/scout.png"><div class="name">Scout</div><div class="cost">3</div></div>
      <div class="card" data-unit="spark"><img src="assets/sprites/spark.png"><div class="name">Spark</div><div class="cost">2</div></div>
      <div class="card" data-unit="tank"><img src="assets/sprites/tank.png"><div class="name">Tank</div><div class="cost">4</div></div>
      <div class="card" data-unit="healer"><img src="assets/sprites/healer.png"><div class="name">Healer</div><div class="cost">3</div></div>
      <div class="card" id="restart"><div class="name">Riavvia</div>↻</div>
    </div>
  </div>
</div>
<div class="rotate-hint" style="display:none;">Ruota in verticale per giocare</div>
<script defer src="main.js"></script>
<script>
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => navigator.serviceWorker.register('./sw.js'));
  }
  // Rotate hint
  function updateOrientationHint(){
    const isLandscape = window.matchMedia("(orientation: landscape)").matches;
    document.querySelector('.rotate-hint').style.display = isLandscape ? 'flex' : 'none';
  }
  updateOrientationHint();
  window.addEventListener('orientationchange', updateOrientationHint);
  window.addEventListener('resize', updateOrientationHint);
</script>
</body>
</html>
